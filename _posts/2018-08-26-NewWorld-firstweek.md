---
layout:     post
title:      å®ä¹ å·¥ä½œï¼ˆä¸€ï¼‰
subtitle:   è®°å½•æ¯å‘¨å­¦ä¹ çš„å†…å®¹
date:       2018-08-26
author:     Hxd
header-img: img/city.jpg
catalog: true
tags: å®ä¹ 
---


## æ˜ŸæœŸä¸€

å‘½ä»¤ï¼š`kubectl cordon runner` ä½¿runnerä¸åˆ†é…pod

è·å¾—é™æƒè§’è‰²åï¼š
- åˆ›å»ºäº†ä¸€ä¸ªåº”ç”¨ï¼Œç¼–ç ä¸ºc7nï¼Œåç§°çŒªé½¿é±¼ä¿®æ”¹å™¨ï¼Œæ¨¡æ¿ä¸é€‰æ‹©
- ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªç¨‹åºæ¨¡æ¿
- gitå…‹éš†ä¸‹æ¥
- å®‰è£…golangå¼€ç¯å¢ƒ
- åœ¨ç”¨ç”¨æˆ·åä¸‹çš„GOç›®å½•ä¸‹åˆ›å»ºåº”ç”¨æ–‡ä»¶å¤¹å¹¶æŠŠå…‹éš†ä¸‹æ¥çš„å¤åˆ¶è¿‡æ¥ï¼š`~/go/src/github.com/choerodon/c7n`
- å®‰è£…goçš„ä¾èµ–åŒ…ç„¶åè¿›è¡Œå¼€å‘
- åœ¨å®‰è£…goä¾èµ–çš„æ—¶å€™ä½¿ç”¨`go install`å‘½ä»¤å³å¯
- è¿™é‡Œè¦æ³¨æ„çš„æ˜¯gitçš„åˆ†æ”¯ï¼Œä¸è¦pushé”™è¯¯äº†ï¼Œè¿˜æœ‰è¦æ³¨æ„commitçš„æ ¼å¼å’Œæ–¹æ³•ï¼Œè¿™é‡Œå¤ä¹ ä¸€ä¸‹ï¼š

[IMP] æå‡æ”¹å–„æ­£åœ¨å¼€å‘æˆ–è€…å·²ç»å®ç°çš„åŠŸèƒ½

[FIX] ä¿®æ­£BUG

[REF] é‡æ„ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯¹åŠŸèƒ½é‡å†™

[ADD] æ·»åŠ å®ç°æ–°åŠŸèƒ½

[REM] åˆ é™¤ä¸éœ€è¦çš„æ–‡ä»¶

æ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¸»è¦å›´ç»•k8sçš„apiæ¥å®Œæˆï¼Œè°ƒç”¨apiè·å–clientçš„æ•°æ®å¹¶å¤„ç†ï¼Œå…¶å®éš¾åº¦å°±åœ¨gitçš„åŸºç¡€ä½¿ç”¨ã€åŠŸèƒ½çš„åšæ³•å’Œæ€è·¯ï¼Œå¦‚ä½•å†™å‡ºé«˜æ•ˆè€Œè®©åˆ«äººæ˜“æ‡‚çš„ä»£ç åº”è¯¥æ˜¯å…³æ³¨çš„é‡ç‚¹ï¼ŒåŒ…æ‹¬logè®°å½•å’Œcommitå†…å®¹ç­‰ç­‰ã€‚è¿˜æœ‰é‡è¦çš„ä¸€ç‚¹æ˜¯åŸºæœ¬ç”¨åˆ°çš„è‹±è¯­å•è¯åº”è¯¥è¦ç†Ÿé€å¹¶è¡¨è¾¾æ¸…æ¥šã€‚

golangè¯­è¨€ç›¸å…³ï¼š

å‡½æ•°åé¦–å­—æ¯å¤§å†™è¡¨ç¤ºå…±æœ‰çš„ï¼Œå°±åƒpublicä¿®é¥°ä¸€æ ·ï¼Œä¸ç„¶åªèƒ½åœ¨æœ¬æ–‡ä»¶å†…è¢«è°ƒç”¨ã€‚

å˜é‡æ ¼å¼å£°æ˜ä¸º`var name [ç±»å‹]`


#### k8sç›¸å…³çš„å†…å®¹

ä¸»è¦ç»„ä»¶ï¼š

**Etcd**ï¼šæ˜¯ä¸€ä¸ªåŸºäºkey-valueçš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œç±»ä¼¼äºRedisï¼Œç”¨äºæœåŠ¡å‘ç°ã€å…±äº«é…ç½®ä»¥åŠä¸€è‡´æ€§ä¿éšœï¼Œä»–å®ƒçš„åŠŸèƒ½ä¸»è¦æ˜¯1.åŸºäºkey-valueçš„å­˜å‚¨  2.ç›‘å¬æœºåˆ¶  3.keyçš„è¿‡æœŸåŠç»­çº¦æœºåˆ¶ï¼Œç”¨äºç›‘æ§å’ŒæœåŠ¡å‘ç°  4.åŸå­CASå’ŒCADï¼Œç”¨äºåˆ†å¸ƒå¼é”å’Œleaderé€‰ä¸¾
å…¶å®å°±æŠŠå®ƒå½“ä½œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼éå…³ç³»å‹æ•°æ®åº“å°±å¯ä»¥äº†

**kube-apiserver**ï¼šä»Šå¤©å†™çš„goéƒ½æ˜¯å›´ç»•ç€è¿™ä¸ªapiå†™çš„ï¼Œå®ƒæä¾›é›†ç¾¤ç®¡ç†çš„ REST API æ¥å£ï¼ŒåŒ…æ‹¬è®¤è¯æˆæƒã€æ•°æ®æ ¡éªŒä»¥åŠé›†ç¾¤çŠ¶æ€å˜æ›´ç­‰æä¾›å…¶ä»–æ¨¡å—ä¹‹é—´çš„æ•°æ®äº¤äº’å’Œé€šä¿¡çš„æ¢çº½ï¼ˆå…¶ä»–æ¨¡å—é€šè¿‡ API Server æŸ¥è¯¢æˆ–ä¿®æ”¹æ•°æ®ï¼Œåªæœ‰ API Server æ‰ç›´æ¥æ“ä½œ etcdï¼‰è°ƒç”¨apiçš„æ–¹å¼æœ‰ä¸‰ç§ï¼š1.ç¨‹åºé‡Œä½¿ç”¨apiå‡½æ•°  2.uiç•Œé¢çš„å·¥å…· 3.cliå‘½ä»¤è¡Œç•Œé¢

**kube-controller-manage**ï¼šController Managerç”±kube-controller-managerå’Œcloud-controller-managerç»„æˆï¼Œæ˜¯Kubernetesçš„å¤§è„‘ï¼Œå®ƒé€šè¿‡apiserverç›‘æ§æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ï¼Œå¹¶ç¡®ä¿é›†ç¾¤å¤„äºé¢„æœŸçš„å·¥ä½œçŠ¶æ€ã€‚åˆ†åˆ«æœ‰å¾ˆå¤šcontrollerç»„æˆ

**kube-scheduler**ï¼šèµ„æºè°ƒåº¦ï¼Œkube-scheduler è´Ÿè´£åˆ†é…è°ƒåº¦ Pod åˆ°é›†ç¾¤å†…çš„èŠ‚ç‚¹ä¸Šï¼Œå®ƒç›‘å¬ kube-apiserverï¼ŒæŸ¥è¯¢è¿˜æœªåˆ†é… Node çš„ Podï¼Œç„¶åæ ¹æ®è°ƒåº¦ç­–ç•¥ä¸ºè¿™äº› Pod åˆ†é…èŠ‚ç‚¹ï¼ˆæ›´æ–° Pod çš„ NodeName å­—æ®µï¼‰æ¯”å¦‚ä½¿ç”¨`kubectl cordon runner`ä¹‹åï¼ŒrunnerèŠ‚ç‚¹ä¸Šä¼šæ˜¾ç¤º`Ready,SchedulingDisabled`å³ä¸å¯åˆ†é…pod

**Kubelet**ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ª kubelet æœåŠ¡è¿›ç¨‹ï¼Œé»˜è®¤ç›‘å¬ 10250 ç«¯å£ï¼Œæ¥æ”¶å¹¶æ‰§è¡Œ master å‘æ¥çš„æŒ‡ä»¤ï¼Œç®¡ç† Pod åŠ Pod ä¸­çš„å®¹å™¨ã€‚æ¯ä¸ª kubelet è¿›ç¨‹ä¼šåœ¨ API Server ä¸Šæ³¨å†ŒèŠ‚ç‚¹è‡ªèº«ä¿¡æ¯ï¼Œå®šæœŸå‘ master èŠ‚ç‚¹æ±‡æŠ¥èŠ‚ç‚¹çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¹¶é€šè¿‡ cAdvisor ç›‘æ§èŠ‚ç‚¹å’Œå®¹å™¨çš„èµ„æºã€‚
**Container runtime**å®¹å™¨è¿è¡Œæ—¶ï¼ˆContainer Runtimeï¼‰æ˜¯ Kubernetes æœ€é‡è¦çš„ç»„ä»¶ä¹‹ä¸€ï¼Œè´Ÿè´£çœŸæ­£ç®¡ç†é•œåƒå’Œå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚Kubelet é€šè¿‡ Container Runtime Interface (CRI) ä¸å®¹å™¨è¿è¡Œæ—¶äº¤äº’ï¼Œä»¥ç®¡ç†é•œåƒå’Œå®¹å™¨ã€‚

**kube-proxy**æ¯å°æœºå™¨ä¸Šéƒ½è¿è¡Œä¸€ä¸ª kube-proxy æœåŠ¡ï¼Œå®ƒç›‘å¬ API server ä¸­ service å’Œ endpoint çš„å˜åŒ–æƒ…å†µï¼Œå¹¶é€šè¿‡ iptables ç­‰æ¥ä¸ºæœåŠ¡é…ç½®è´Ÿè½½å‡è¡¡ï¼ˆä»…æ”¯æŒ TCP å’Œ UDPï¼‰ã€‚
kube-proxy å¯ä»¥ç›´æ¥è¿è¡Œåœ¨ç‰©ç†æœºä¸Šï¼Œä¹Ÿå¯ä»¥ä»¥ static pod æˆ–è€… daemonset çš„æ–¹å¼è¿è¡Œï¼Œä»–å…¶å®æ”¹å˜çš„æ˜¯iptablesçš„è½¬å‘åŠŸèƒ½

## æ˜ŸæœŸäºŒ

kibanaçš„ä½¿ç”¨ï¼Œåˆ›å»ºæ—¥å¿—åº”ç”¨å¹¶éƒ¨ç½²ï¼Œæ­å»ºä¸‰ä¸ªèŠ‚ç‚¹çš„k8sé›†ç¾¤ï¼Œé€šè¿‡urlå®šä½å‡ºé”™çš„podï¼Œkunectlå‘½ä»¤çš„ç”¨æ³•

é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªgraphï¼Œå†å¾€é‡Œé¢æ·»åŠ å„ç§å›¾å½¢ï¼Œéœ€è¦æ·»åŠ å˜é‡ï¼Œå˜é‡å­—æ®µå¯ä»¥é€šè¿‡https://prometheus.choerodon.com.cnæ¥è·å–ï¼Œæ·»åŠ ä¹‹åå†é…ç½®è§„åˆ™ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå‡½æ•°`irate`å’Œ`delta`ï¼Œirateè®¡ç®—çš„æ˜¯ç»™å®šæ—¶é—´çª—å£å†…çš„æ¯ç§’ç¬æ—¶å¢åŠ é€Ÿç‡ï¼Œdetaè®¡ç®—èŒƒå›´å‘é‡ä¸­æ¯ä¸ªæ—¶é—´ç³»åˆ—å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå€¼ä¹‹é—´çš„å·®å¼‚vï¼Œè¿”å›å…·æœ‰ç»™å®šå¢é‡å’Œç­‰æ•ˆæ ‡ç­¾çš„å³æ—¶å‘é‡ã€‚deltaè¢«å¤–æ¨ä»¥è¦†ç›–èŒƒå›´å‘é‡é€‰æ‹©å™¨ä¸­æŒ‡å®šçš„å…¨æ—¶é—´èŒƒå›´ï¼Œå› æ­¤å³ä½¿æ ·æœ¬å€¼éƒ½æ˜¯æ•´æ•°ï¼Œä¹Ÿå¯ä»¥è·å¾—éæ•´æ•°ç»“æœã€‚æ¯”å¦‚ï¼š`irate(http_server_requests_seconds_count{pod_name="$instance"}[25s])`ä»£è¡¨æ¯ç§’çš„è¯·æ±‚æ•°é‡ï¼Œ`http_server_requests_seconds_count`è¿™ä¸ªå­—æ®µæ˜¯ç´¯ç§¯çš„è¯·æ±‚æ•°é‡ï¼Œ25sçš„æ„æ€æ˜¯ä»0~25så†…çš„æ—¶é—´ã€‚
å†æ¯”å¦‚`delta(http_server_requests_seconds_count{pod_name="$instance"}[25s])`ä»£è¡¨çš„æ˜¯è¯·æ±‚çš„å·®å€¼ã€‚

#### æ—¥å¿—ç®¡ç†

ä¸»è¦çš„æ¶æ„å¦‚å›¾æ‰€ç¤º:

![](http://pbqgh436d.bkt.clouddn.com/18-8-21/78054037.jpg)

fluent-bitæ˜¯è®°å½•æ—¥å¿—çš„ç»„ä»¶ï¼Œæ¯ä¸ªé›†ç¾¤éƒ½ä¼šè¿è¡Œè¿™ä¸ªæœåŠ¡ï¼Œæ—¥å¿—é€šè¿‡fluentdè¢«è½¬å‘è‡³esæœåŠ¡å™¨é›†ç¾¤ï¼ˆæƒ³è±¡å®ƒåªæœ‰ä¸€ä¸ªå®ä½“ï¼‰ï¼Œç„¶åå†ç”±å¯è§†åŒ–å¹³å°æ“ä½œå±•ç°æ•°æ®ã€‚

ä»Šå¤©ä¸»è¦éƒ¨ç½²çš„åº”ç”¨ç”±eså’Œkibanaã€‚ç„¶åé‡ç‚¹äº†è§£fluent-bitçš„ç”¨æ³•ï¼š

fbçš„æ¶æ„ï¼š

![](http://pbqgh436d.bkt.clouddn.com/18-8-21/86026463.jpg)
**input**ï¼šå°±æ˜¯ä¸€ç³»åˆ—çš„æ—¥å¿—è®°å½•è¾“å…¥

**parser**ï¼šæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ¥è¿‡æ»¤çš„

**filter**ï¼šè¿‡æ»¤å™¨

**buffer**ï¼šç¼“å†²åŒº

**routing**ï¼šåˆ†å‘è·¯ç”±

**output**ï¼šè¾“å‡º


### K8s

URIç”¨äºpodçš„èµ„æºå®šä½

etcdä¿å­˜æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€
apiservreræä¾›å…¥å£
controllerè´Ÿè´£ç»´æŠ¤é›†ç¾¤çš„çŠ¶æ€
scheduleè´Ÿè´£èµ„æºçš„è°ƒåº¦
kubectlè´Ÿè´£ç»´æŠ¤å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬Valumeï¼ˆCVIï¼‰å’Œç½‘ç»œï¼ˆCNIï¼‰
container runtimeè´Ÿè´£é•œåƒç®¡ç†ä»¥åŠpodå’Œå®¹å™¨çš„çœŸæ­£è¿è¡Œï¼ˆCRIï¼‰
kube-proxyè´Ÿè´£ä¸ºserviceæä¾›clusterå†…éƒ¨çš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡
kube-dnsè´Ÿè´£ä¸ºæ•´ä¸ªé›†ç¾¤æä¾›DNSæœåŠ¡
ingress controllerä¸ºæœåŠ¡æä¾›å¤–ç½‘å…¥å£
Heapsteræä¾›èµ„æºç›‘æ§
Dashboardæä¾›GUI
Federationæä¾›è·¨å¯ç”¨åŒºçš„é›†ç¾¤
Fluentd-elasticsearch æä¾›é›†ç¾¤æ—¥å¿—é‡‡é›†ã€å­˜å‚¨ä¸æŸ¥è¯¢


## æ˜ŸæœŸä¸‰
#### Prometheus configé…ç½®çš„åŸºæœ¬æ¦‚å¿µ

```
global:        #å…¨å±€çš„é…ç½®ï¼Œä¼˜å…ˆå€¼æ¯”è¾ƒä¸‹é¢çš„ä½
  scrape_interval: 10s   #æŠ“å–çš„æ—¶é—´é—´éš”
  scrape_timeout: 10s    #æŠ“å–çš„è¶…æ—¶æ—¶é—´
  evaluation_interval: 10s   #æ‰§è¡Œçš„æ—¶é—´é—´éš”
alerting:    #ä»¥ä¸‹å…ˆä¸çœ‹
  alertmanagers:
  - static_configs:
    - targets:
      - alertmanager-choerodon-monitoring-369d9:9093
    scheme: http
    path_prefix: /
    timeout: 10s
rule_files:
- /etc/prometheus-rules/*.rules
scrape_configs:             #å¸¸ç”¨çš„æŠ“å–é…ç½®æ–‡ä»¶
- job_name: kubernetes-pod  #å°±æ˜¯ä¸€ä¸ªjobçš„åå­—
  scrape_interval: 10s      #æŠ“å–çš„æ—¶é—´é—´éš”ä¼˜å…ˆäºglobal
  scrape_timeout: 10s       #æŠ“å–çš„è¶…æ—¶æ—¶é—´
  metrics_path: /metrics    #æŠ“å–çš„æŒ‡æ ‡è·¯å¾„
  scheme: http              #åè®®æ ¼å¼http
  kubernetes_sd_configs:    #kubernetesæœåŠ¡å‘ç°
  - api_server: null        #
    role: pod               #æŒ‡å®šæŠ“å–çš„å¯¹è±¡ä¸ºpodï¼Œå¯é€‰çš„å€¼æœ‰pod,node,service,ingress,endpoints
    namespaces:             #
      names: []             #
  relabel_configs:          #æ ¹æ®è§„åˆ™æ›¿æ¢ä¸€äº›æ ‡ç­¾æ•°æ®
  - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]#æ˜¯å¦å£°æ˜äº†prometheus_io_scrapeï¼Œæ˜¯ï¼Œåˆ™æ›¿æ¢æ‰
    separator: ;
    regex: "true"
    replacement: $1  #æ›¿æ¢ä¸ºä¸Šé¢å£°æ˜çš„
    action: keep     #è¿™é‡Œç†è§£ä¸ºï¼Œå¦‚æœå£°æ˜äº†scrapeï¼Œå°±ä¿æŒä½ï¼Œå°±æ˜¯ä¸éœ€è¦ç›‘æ§å…¨éƒ¨çš„pod
  - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scheme]#å£°æ˜æ›¿æ¢åè®®æ ¼å¼
    separator: ;
    regex: (https?)
    target_label: __scheme__
    replacement: $1
    action: replace
  - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]#å£°æ˜æ›¿æ¢socketåœ°å€ï¼Œæ¯”å¦‚ä¸€ä¸ªlabelå£°æ˜äº†å¤šä¸ªç«¯å£ï¼Œé‚£è¯¥å»å“ªä¸ªç«¯å£é‚£ç›‘æ§æ•°æ®å‘¢ï¼Œè¿™é‡Œæ¯”å¦‚æŒ‡å®šäº†æŸä¸ªç«¯å£ï¼Œå°±ç”¨è¯¥ç«¯å£æ›¿æ¢æ‰ï¼Œä»è€Œèƒ½é€šè¿‡è¯¥åœ°å€è®¿é—®ç›‘æ§æ•°æ®
    separator: ;                 #å€¼ä¸ºç©ºï¼Œä»¥;åˆ†éš”
    regex: (.+)(?::\d+);(\d+)    #æ­£åˆ™è¡¨è¾¾ï¼Œæ›¿æ¢ç«¯å£å·
    target_label: __address__
    replacement: $1:$2           #å°±æ˜¯æ›¿æ¢ _address_ é‡Œçš„ç«¯å£å·ä¸ºprometheus_io_port
    action: replace              #æ›¿æ¢æ‰
  - source_labels: [__meta_kubernetes_pod_name]  #podå¯¹è±¡çš„åå­—
    separator: ;
    regex: (.*)
    target_label: pod_name
    replacement: $1
    action: replace
  - source_labels: [__metrics_path__]  #æ›¿æ¢æŒ‡æ ‡çš„åœ°å€
    separator: ;
    regex: (.*)
    target_label: cluster
    replacement: choerodon-prod
    action: replace
```


```
<match add>
  @type stdout
</match>

<match cp>
  @type stdout
</match>

<match kube.log>
  @type rewrite_tag_filter
  <rule>
    key log  
    pattern ^.*\ c\.p\.\ .*  
    tag cp  
  </rule>
  <rule>
    key log
    pattern ^.*
    tag add  
  </rule>
</match>


<match d.**>
  @type stdout
</match>

<match kubernetes.**>
  @type rewrite_tag_filter
  <rule>
    key $['kubernetes']['namespace_name']
    pattern ^(.+)$
    tag $1.${tag}
  </rule>
</match>

192.168.12.180 2333
```

## æ˜ŸæœŸå››

```
[INPUT]
    Name mem
    Tag  mem.local

[OUTPUT]
    Name  stdout
    Match *

[FILTER]
    Name record_modifier
    Match msg
    Record msg $re
    
```

```
$4 = 0x8b8750 "{\"index\":{\"_index\":\"my_index\",\"_type\":\"my_type\"}}\n{\"@timestamp\":\"2018-08-23T06:34:55.679Z\", \"cpu_p\":98.000000, \"user_p\":81.000000, \"system_p\":17.000000, \"cpu0_p_cpu\":98.000000, \"cpu0_p_user\":81.000000, \"cpu0_p_system\":17.000000}\n"


{
	"index": {
		"_index": "my_index",    ### ->api
		"_type": "my_type"       #
	}
} {
	"@timestamp": "2018-08-23T06:34:55.679Z",
	"cpu_p": 98.000000,
	"user_p": 81.000000,
	"system_p": 17.000000,
	"cpu0_p_cpu": 98.000000,
	"cpu0_p_user": 81.000000,
	"cpu0_p_system": 17.000000
}

bin/fluent-bit -i mem -o es://192.168.99.100:9200/test_index1/test_type1
```

## æ˜ŸæœŸäº”


## å‘¨æœ«

- å­¦golang
- çœ‹ä¸€ä¸‹grpc

æ€»ç»“ä¸‹å§ï¼Œæ€»çš„æ¥è¯´éƒ½æ˜¯åœ¨å­¦ä¹ æ–°çš„çŸ¥è¯†ï¼Œå¯¼å¸ˆåˆ†é…ä»»åŠ¡çš„æ—¶å€™æ„Ÿè§‰æ‘¸ä¸ç€å¤´è„‘ï¼Œæ™ºå•†ä¸å¤Ÿç”¨äº†ğŸ˜‚ï¼Œé¡¹ç›®éœ€è¦ç”¨golangï¼Œå¯¹äºä¸»è¦ä½¿ç”¨c/c++å’Œjavaçš„æˆ‘æ¥è¯´å…¥é—¨golangè¿˜æ˜¯è›®è½»æ¾çš„ï¼Œæ„Ÿè§‰å°±æ˜¯Cï¼Œjavaï¼Œpythonï¼ˆåˆ‡ç‰‡ï¼‰çš„ç»“åˆä½“ã€‚å¯ä»¥å¿«é€Ÿå¼€å‘ã€‚

grpcï¼Œå…ˆè¯´rpcå§ï¼Œå°±æ˜¯æœ¬åœ°è¿œç¨‹è°ƒç”¨æœåŠ¡ç«¯çš„å‡½æ•°èµ„æºå•¥çš„ã€‚grpcå°±æ˜¯ä»¥[protocol buffer](https://developers.google.com/protocol-buffers/docs/overview)ä½œä¸ºåºåˆ—åŒ–ç»„ä»¶çš„rpcï¼Œpbæ˜¯Googleå®¶çš„å¼€æºå·¥å…·--ä¸€ç§ä¸è¯­è¨€æ— å…³ï¼Œå¹³å°æ— å…³ï¼Œå¯æ‰©å±•çš„åºåˆ—åŒ–ç»“æ„åŒ–æ•°æ®çš„æ–¹æ³•ï¼Œç”¨äºé€šä¿¡åè®®ï¼Œæ•°æ®å­˜å‚¨ç­‰ã€‚

grpcæœ‰å››ä¸­é€šä¿¡ï¼ˆè°ƒç”¨æ–¹å¼ï¼‰ï¼Œå³ç®€å•ä¸€å…ƒå¼rpcï¼ŒæœåŠ¡ç«¯æµå¼rpcï¼Œå®¢æˆ·ç«¯æµå¼rpcï¼ŒåŒå‘æµå¼rpcã€‚æ¯”å¦‚å‘å¾®ä¿¡ï¼Œå‡è®¾ä¸€ç«¯æ˜¯å®¢æˆ·ç«¯ï¼Œå¦ä¸€ç«¯æ˜¯æœåŠ¡ç«¯ï¼Œä¸€å…ƒå¼rpcå°±æ˜¯å®¢æˆ·ç«¯å‘ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡ç«¯å›åº”ä¸€ä¸ªè¯·æ±‚ï¼ˆæ¯”å¦‚æ­£å¸¸çš„å‡½æ•°è°ƒç”¨ï¼‰ã€‚æœåŠ¡ç«¯æµå¼å°±æ˜¯ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡ç«¯å¤šä¸ªæ¶ˆæ¯ã€‚å®¢æˆ·ç«¯æµå°±æ˜¯å®¢æˆ·ç«¯å‘é€å¤šä¸ªæ¶ˆæ¯ï¼ŒåŒå‘æµå°±æ˜¯ä»–ä»¬çš„ç»“åˆï¼Œè€Œä¸”äº’ä¸å½±å“